#pragma subsystem(WINDOWS_GUI)

Application.Run(new Form1);

class Form1 : Form
{
	const string message = "Andromeda Test Window";
	
	function ctor
	{
		Text = Path.GetFileNameWithoutExtension(
			Application.ExecutablePath)
			.Replace("-", " ");
		SetClientSize(256, 256);
	}
	
	override OnPaint(e : PaintEventArgs)
	{
		e.hDC.TextOut(8, 8, message, message.Length);
		base.OnPaint(e);
	}
	
	override OnMouseDown(e : MouseEventArgs)
	{
		switch (e.Button)
		{
			case MK_LBUTTON:
				MyFillRect(e);
				break;
			case MK_RBUTTON:
				hWnd.InvalidateRect(null, true);
				break;
		}
		base.OnMouseDown(e);
	}
	
	override OnMouseMove(e : MouseEventArgs)
	{
		if (e.Button & MK_LBUTTON) MyFillRect(e);
		base.OnMouseMove(e);
	}
	
	function MyFillRect(e : MouseEventArgs)
	{
		var hdc = hWnd.GetDC();
		var brush = GetSysColorBrush(COLOR_WINDOWTEXT);
		RECT rect = { e.X - 2, e.Y - 2, e.X + 2, e.Y + 2 };
		hdc.FillRect(rect, brush);
	}
}
